<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üíª System Breach ‚Äî Operation Catnip</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;600&display=swap');
  * { margin: 0; padding: 0; box-sizing: border-box; }
  
  body {
    background: 
      linear-gradient(rgba(10, 15, 26, 0.85), rgba(10, 15, 26, 0.85)),
      url('https://images.unsplash.com/photo-1550745165-9bc0b252726f?w=1920&q=80') center/cover fixed;
    color: #dbeefd;
    font-family: 'Fira Code', monospace;
    height: 100vh;
    overflow: hidden;
    position: relative;
  }


  body::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: 
      repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(255,255,255,0.02) 2px, rgba(255,255,255,0.02) 4px);
    pointer-events: none;
    animation: scanlines 8s linear infinite;
  }

  @keyframes scanlines {
    0% { transform: translateY(0); }
    100% { transform: translateY(4px); }
  }


  .desktop {
    padding: 20px;
    display: grid;
    grid-template-columns: repeat(auto-fill, 100px);
    gap: 20px;
    height: calc(100vh - 50px);
    align-content: start;
  }

  .desktop-icon {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    padding: 12px;
    border-radius: 8px;
    transition: all 0.2s ease;
    width: 100px;
    text-align: center;
  }

  .desktop-icon:hover {
    background: rgba(255,255,255,0.1);
    transform: translateY(-2px);
  }

  .desktop-icon:active {
    transform: translateY(0);
  }

  .icon-image {
    font-size: 3rem;
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
  }

  .icon-label {
    font-size: 0.75rem;
    color: #fff;
    text-shadow: 0 1px 3px rgba(0,0,0,0.8);
    word-break: break-word;
  }

 
  .taskbar {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    height: 50px;
    background: linear-gradient(180deg, #1a1f2e 0%, #0f1419 100%);
    border-top: 1px solid rgba(124, 58, 237, 0.3);
    display: flex;
    align-items: center;
    padding: 0 15px;
    gap: 10px;
    box-shadow: 0 -2px 10px rgba(0,0,0,0.5);
    z-index: 2000;
  }

  .taskbar-app {
    padding: 8px 16px;
    background: rgba(124, 58, 237, 0.2);
    border-radius: 6px;
    font-size: 0.85rem;
    color: #7ef29b;
    cursor: pointer;
    transition: all 0.2s ease;
    border: 1px solid transparent;
  }

  .taskbar-app:hover {
    background: rgba(124, 58, 237, 0.4);
    border-color: rgba(124, 58, 237, 0.6);
  }

  .taskbar-app.active {
    background: rgba(124, 58, 237, 0.6);
    border-color: #7c3aed;
  }

  .taskbar-clock {
    margin-left: auto;
    font-size: 0.9rem;
    color: #9fb3c8;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .timer-badge {
    padding: 4px 12px;
    background: rgba(255, 77, 77, 0.2);
    border-radius: 4px;
    font-size: 0.85rem;
    color: #ff4d4d;
    border: 1px solid rgba(255, 77, 77, 0.3);
  }

  .timer-badge.warning {
    animation: pulse 1s infinite;
  }

 
  .terminal-window {
    position: fixed;
    background: #0a0f1a;
    border-radius: 10px;
    box-shadow: 0 10px 50px rgba(0,0,0,0.7);
    width: 700px;
    max-width: 90vw;
    max-height: 80vh;
    z-index: 1000;
    display: none;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
  }

  .terminal-window.show { 
    display: flex; 
    flex-direction: column;
  }
  
  .terminal-window.minimized { display: none; }

  .window-header {
    background: linear-gradient(180deg, #2d3548 0%, #1e2635 100%);
    display: flex;
    align-items: center;
    padding: 10px 12px;
    gap: 8px;
    border-bottom: 1px solid rgba(255,255,255,0.05);
    cursor: move;
    border-radius: 10px 10px 0 0;
  }

  .window-controls {
    display: flex;
    gap: 8px;
  }

  .window-btn {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .window-btn.close { background: #ff5f56; }
  .window-btn.minimize { background: #ffbd2e; }
  .window-btn.maximize { background: #27c93f; }

  .window-btn:hover {
    filter: brightness(1.2);
    transform: scale(1.1);
  }

  .window-title {
    color: #7ef29b;
    font-size: 0.9rem;
    margin-left: 8px;
  }

  .terminal-body {
    padding: 18px;
    overflow-y: auto;
    max-height: 60vh;
    flex-grow: 1;
    scroll-behavior: smooth;
    display: flex;
    flex-direction: column;
  }

  .output {
    white-space: pre-wrap;
    line-height: 1.6;
    margin-bottom: 8px;
    opacity: 0;
    animation: fadeIn 0.3s forwards;
  }

  @keyframes fadeIn {
    to { opacity: 1; }
  }

  .output.typing {
    animation: typing 0.5s steps(40) forwards, fadeIn 0.1s forwards;
  }

  .progress-bar-container {
    margin: 12px 0;
    padding: 8px 0;
  }

  .progress-bar-bg {
    width: 100%;
    height: 20px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
    overflow: hidden;
    border: 1px solid rgba(126, 242, 155, 0.3);
  }

  .progress-bar-fill {
    height: 100%;
    background: linear-gradient(90deg, #7ef29b, #5ce080);
    width: 0%;
    transition: width 0.1s linear;
    box-shadow: 0 0 10px rgba(126, 242, 155, 0.5);
  }

  .progress-text {
    color: #7ef29b;
    font-size: 0.9rem;
    margin-top: 6px;
  }

  .success-message {
    color: #7ef29b;
    text-shadow: 0 0 10px rgba(126, 242, 155, 0.5);
    animation: glow 2s ease-in-out;
  }

  @keyframes glow {
    0%, 100% { text-shadow: 0 0 10px rgba(126, 242, 155, 0.5); }
    50% { text-shadow: 0 0 20px rgba(126, 242, 155, 0.8); }
  }

  .input-line {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-top: 10px;
  }

  .prompt { color: #7ef29b; }

  input {
    flex-grow: 1;
    background: transparent;
    border: none;
    outline: none;
    color: #eaffef;
    font-family: 'Fira Code', monospace;
    font-size: 1rem;
  }

 
  .notepad-window {
    position: fixed;
    background: #f5f5f5;
    border-radius: 10px;
    box-shadow: 0 10px 50px rgba(0,0,0,0.7);
    min-width: 450px;
    max-width: 600px;
    z-index: 1001;
    display: none;
  }

  .notepad-window.show { display: flex; flex-direction: column; }

  .notepad-header {
    background: linear-gradient(180deg, #e8e8e8, #d4d4d4);
    border-bottom: 1px solid #aaa;
    padding: 10px 12px;
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: move;
    border-radius: 10px 10px 0 0;
  }

  .notepad-title {
    font-size: 0.9rem;
    color: #333;
    font-weight: 600;
    margin-left: 8px;
  }

  .notepad-content {
    background: white;
    padding: 20px;
    font-family: 'Courier New', monospace;
    color: #000;
    min-height: 250px;
    max-height: 400px;
    overflow-y: auto;
    white-space: pre-wrap;
    font-size: 0.95rem;
    line-height: 1.6;
    border-radius: 0 0 10px 10px;
  }

  button {
    margin-top: 20px;
    padding: 14px 26px;
    font-size: 1rem;
    background: linear-gradient(90deg, #7c3aed, #5b21b6);
    color: #fff;
    border: 0;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: 0.25s ease;
    opacity: 0;
    animation: fadeInButton 0.5s ease forwards;
  }

  @keyframes fadeInButton {
    to { opacity: 1; }
  }

  button:hover {
    transform: scale(1.05);
    background: linear-gradient(90deg, #8b5cf6, #6d28d9);
    box-shadow: 0 0 12px rgba(124, 58, 237, 0.4);
  }

  .center { 
    text-align: center; 
    margin-top: 20px;
  }
  
  .hidden { display: none; }

  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
  }

  .terminal-spacer {
    flex-grow: 1;
    min-height: 20px;
  }
</style>
</head>
<body>
  <!-- Desktop Icons -->
  <div class="desktop">
    <div class="desktop-icon" onclick="openTerminal()">
      <div class="icon-image">üíª</div>
      <div class="icon-label">Terminal</div>
    </div>
    <div class="desktop-icon" onclick="openFile('log1.txt')">
      <div class="icon-image">üìÑ</div>
      <div class="icon-label">log1.txt</div>
    </div>
    <div class="desktop-icon" onclick="openFile('cipher.txt')">
      <div class="icon-image">üìÑ</div>
      <div class="icon-label">cipher.txt</div>
    </div>
    <div class="desktop-icon" onclick="openFile('access.enc')">
      <div class="icon-image">üîí</div>
      <div class="icon-label">access.enc</div>
    </div>
  </div>

  <!-- Terminal Window -->
  <div class="terminal-window" id="terminalWindow">
    <div class="window-header" id="terminalHeader">
      <div class="window-controls">
        <div class="window-btn close" onclick="closeWindow('terminalWindow')"></div>
        <div class="window-btn minimize" onclick="minimizeWindow('terminalWindow')"></div>
        <div class="window-btn maximize"></div>
      </div>
      <span class="window-title">Terminal ‚Äî agent@kiki:~</span>
    </div>
    <div class="terminal-body" id="terminal">
      <div id="outputContainer">
        <div class="output" id="output"></div>
      </div>
      <div class="terminal-spacer"></div>
      <div class="input-line" id="mainInputLine">
        <span class="prompt">agent@kiki:~$</span>
        <input type="text" id="commandInput" autocomplete="off" placeholder="type a command..." />
      </div>
      <div class="input-line hidden" id="passwordLine">
        <span class="prompt">Password required:</span>
        <input type="text" id="passwordInput" autocomplete="off" />
      </div>
      <div id="buttonContainer" class="center hidden">
        <button onclick="window.location.href='dashboard.html'">üß≠ Return to Dashboard</button>
      </div>
    </div>
  </div>

  <!-- Notepad Window -->
  <div class="notepad-window" id="notepadWindow">
    <div class="notepad-header" id="notepadHeader">
      <div class="window-controls">
        <div class="window-btn close" onclick="closeWindow('notepadWindow')"></div>
        <div class="window-btn minimize" onclick="minimizeWindow('notepadWindow')"></div>
        <div class="window-btn maximize"></div>
      </div>
      <span class="notepad-title" id="notepadTitle">Text Editor</span>
    </div>
    <div class="notepad-content" id="notepadContent"></div>
  </div>

  <!-- Taskbar -->
  <div class="taskbar">
    <div class="taskbar-app" id="terminalTask" onclick="toggleWindow('terminalWindow', 'terminalTask')">
      üñ•Ô∏è Terminal
    </div>
    <div class="taskbar-app hidden" id="notepadTask" onclick="toggleWindow('notepadWindow', 'notepadTask')">
      üìù Text Editor
    </div>
    <div class="taskbar-clock">
      <div class="timer-badge" id="timer">‚ö†Ô∏è Initializing...</div>
      <span id="clock">00:00</span>
    </div>
  </div>

<script>
const output = document.getElementById('output');
const input = document.getElementById('commandInput');
const passwordInput = document.getElementById('passwordInput');
const buttonContainer = document.getElementById('buttonContainer');
const passwordLine = document.getElementById('passwordLine');
const mainInputLine = document.getElementById('mainInputLine');
const timerDisplay = document.getElementById('timer');
const terminalWindow = document.getElementById('terminalWindow');
const notepadWindow = document.getElementById('notepadWindow');
const notepadTitle = document.getElementById('notepadTitle');
const notepadContent = document.getElementById('notepadContent');
const terminalTask = document.getElementById('terminalTask');
const notepadTask = document.getElementById('notepadTask');

let stage = 0;
let awaitingPassword = false;
let attemptsLeft = 3;
let timeLeft = 101;
let timerInterval;
let windowInitialized = false;

const files = {
  'log1.txt': 'V2hhdCBkbyBjYXRzIGRvPyBUaGVpciBtb3ZlcyBoYXZlIHRoZSBhbnN3ZXIuIFRoZSByZXN0IGlzIGhpZGRlbiBpbiB0aGUgY2lwaGVyLg==',
  'cipher.txt': '01010100 01101000 01100101 00100000 01100011 01100001 01110100 00100000 01001101 01000101 01001111 01010111 01010011 00100000 01100001 01110100 00100000 01100101 01110110 01100101 01110010 01111001 01101111 01101110 01100101 00101110',
  'access.enc': '[ENCRYPTED DATA - PASSWORD REQUIRED]',
  'access.enc.decrypted': `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
  OPERATION CATNIP - FINAL INTELLIGENCE
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

CLASSIFIED LEVEL: WHISKER-EYES-ONLY

Agent Kiki,

You've successfully penetrated the encrypted 
network. The following intelligence has been 
recovered from the secure node:

TARGET: Mrs. Bianca
STATUS: Located in Server Room U-3
SECURITY: Laser grid active
WEAKNESS: Distracted by red dot patterns

MISSION OBJECTIVE:
Retrieve the Catnip Formula from the secure
vault before the timer expires.

Your clue for the next phase:
üîë THE THIRD CLUE IS: "KIKS"

Remember: Nine lives, one mission.

-- Feline Intelligence Division
   üêæ MEOW Command Central

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
[END TRANSMISSION]`
};

// Clock
function updateClock() {
  const now = new Date();
  const hours = String(now.getHours()).padStart(2, '0');
  const minutes = String(now.getMinutes()).padStart(2, '0');
  document.getElementById('clock').textContent = `${hours}:${minutes}`;
}
setInterval(updateClock, 1000);
updateClock();

// Window Management
function openTerminal() {
  terminalWindow.classList.add('show');
  terminalWindow.classList.remove('minimized');
  terminalTask.classList.add('active');
  
  // Initialize position on first open
  if (!windowInitialized) {
    terminalWindow.style.left = '50%';
    terminalWindow.style.top = '50%';
    terminalWindow.style.transform = 'translate(-50%, -50%)';
    windowInitialized = true;
  }
  
  input.focus();
}

function openFile(filename) {
  if (filename === 'access.enc') {
    openTerminal();
    setTimeout(() => {
      print("‚ö†Ô∏è File is encrypted. Use terminal command 'unlock access.enc' to decrypt.", "#f2a6a6");
    }, 100);
    return;
  }

  if (filename === 'cipher.txt' && stage < 1) {
    openTerminal();
    setTimeout(() => {
      print("‚ö†Ô∏è Hint file locked. Read log1.txt first.", "#f2a6a6");
    }, 100);
    return;
  }

  notepadTitle.textContent = `Text Editor ‚Äî ${filename}`;
  notepadContent.textContent = files[filename];
  notepadWindow.classList.add('show');
  notepadWindow.classList.remove('minimized');
  notepadTask.classList.remove('hidden');
  notepadTask.classList.add('active');
  
  if (!notepadWindow.style.left) {
    notepadWindow.style.left = '100px';
    notepadWindow.style.top = '80px';
  }

  if (filename === 'log1.txt') stage = Math.max(stage, 1);
  if (filename === 'cipher.txt') stage = Math.max(stage, 2);
}

function toggleWindow(windowId, taskId) {
  const win = document.getElementById(windowId);
  const task = document.getElementById(taskId);
  
  if (win.classList.contains('minimized')) {
    win.classList.remove('minimized');
    win.classList.add('show');
    task.classList.add('active');
  } else if (win.classList.contains('show')) {
    win.classList.add('minimized');
    win.classList.remove('show');
    task.classList.remove('active');
  } else {
    win.classList.add('show');
    task.classList.add('active');
  }
}

function minimizeWindow(windowId) {
  const win = document.getElementById(windowId);
  const taskId = windowId === 'terminalWindow' ? 'terminalTask' : 'notepadTask';
  const task = document.getElementById(taskId);
  
  win.classList.add('minimized');
  win.classList.remove('show');
  task.classList.remove('active');
}

function closeWindow(windowId) {
  const win = document.getElementById(windowId);
  const taskId = windowId === 'terminalWindow' ? 'terminalTask' : 'notepadTask';
  const task = document.getElementById(taskId);
  
  win.classList.remove('show');
  win.classList.add('minimized');
  task.classList.remove('active');
  if (windowId === 'notepadWindow') {
    task.classList.add('hidden');
  }
}

// Dragging
function makeDraggable(windowEl, headerEl) {
  let isDragging = false;
  let currentX, currentY, initialX, initialY;

  headerEl.addEventListener('mousedown', (e) => {
    if (e.target.classList.contains('window-btn')) return;
    
    const rect = windowEl.getBoundingClientRect();
    initialX = e.clientX - rect.left;
    initialY = e.clientY - rect.top;
    isDragging = true;
    
    // Remove transform when starting to drag
    windowEl.style.transform = 'none';
  });

  document.addEventListener('mousemove', (e) => {
    if (isDragging) {
      e.preventDefault();
      currentX = e.clientX - initialX;
      currentY = e.clientY - initialY;
      windowEl.style.left = currentX + 'px';
      windowEl.style.top = currentY + 'px';
    }
  });

  document.addEventListener('mouseup', () => {
    isDragging = false;
  });
}

makeDraggable(terminalWindow, document.getElementById('terminalHeader'));
makeDraggable(notepadWindow, document.getElementById('notepadHeader'));

// Timer
function startTimer() {
  timerInterval = setInterval(() => {
    timeLeft--;
    timerDisplay.textContent = `‚ö†Ô∏è ${timeLeft}s`;
    if (timeLeft <= 10) timerDisplay.classList.add('warning');
    if (timeLeft <= 0) { clearInterval(timerInterval); lockSystem(); }
  }, 1000);
}

function print(text, color = "#dbeefd", delay = 0) {
  return new Promise(res => {
    setTimeout(() => {
      const line = document.createElement('div');
      line.className = 'output';
      line.style.color = color;
      line.textContent = text;
      output.appendChild(line);
      const terminalBody = document.querySelector('.terminal-body');
      terminalBody.scrollTop = terminalBody.scrollHeight;
      res();
    }, delay);
  });
}

async function boot() {
  await print("Booting secure terminal interface...", "#9fb3c8", 300);
  await print("Connecting to encrypted node: üêæ ARLY-ONE.NET ", "#7ef29b", 400);
  await print("Connection established. Welcome, agent.", "#7ef29b", 300);
  await print("Type 'help' for available commands.", "#86a7bf", 300);
  startTimer();
}

input.addEventListener('keydown', e => {
  if (e.key === 'Enter') {
    const cmd = input.value.trim();
    input.value = '';
    handleCommand(cmd);
  }
});

passwordInput.addEventListener('keydown', e => {
  if (e.key === 'Enter') {
    const pass = passwordInput.value.trim();
    passwordInput.value = '';
    handlePassword(pass);
  }
});

function handleCommand(cmd) {
  if (!cmd) return;
  print(`agent@kiki:~$ ${cmd}`, "#7ef29b");

  const parts = cmd.split(' ');
  const command = parts[0].toLowerCase();
  const arg = parts.slice(1).join(' ');

  switch (command) {
    case "help":
      print("Commands:\n- list / ls ..... view directory\n- cat [file] .... read file (opens in text editor)\n- unlock access.enc\n- whoami\n- clear", "#86a7bf");
      break;

    case "whoami":
      print("Agent Kiki ‚Äî Feline Intelligence Division üêæ", "#7ef29b");
      break;

    case "list":
    case "ls":
      print("Directory:\n- log1.txt\n- cipher.txt\n- access.enc", "#9fb3c8");
      break;

    case "cat":
      if (!arg) {
        print("Usage: cat [filename]", "#f2a6a6");
        break;
      }
      const filename = arg.toLowerCase().replace('.txt', '').replace('.enc', '');
      if (filename === 'log1') {
        openFile('log1.txt');
        print("üìÑ Opening log1.txt in text editor...", "#7ef29b");
      } else if (filename === 'cipher') {
        if (stage < 1) {
          print("‚ö†Ô∏è Hint file locked. Read log1.txt first.", "#f2a6a6");
        } else {
          openFile('cipher.txt');
          print("üìÑ Opening cipher.txt in text editor...", "#7ef29b");
        }
      } else if (filename === 'access') {
        print("‚ö†Ô∏è File is encrypted. Use 'unlock access.enc' to decrypt.", "#f2a6a6");
      } else {
        print(`cat: ${arg}: No such file or directory`, "#f2a6a6");
      }
      break;

    case "unlock":
      if (!arg || !arg.toLowerCase().includes('access')) {
        print("Usage: unlock access.enc", "#f2a6a6");
        break;
      }
      if (stage < 2) {
        print("‚ùå You need to explore the files first", "#f2a6a6");
      } else {
        print("üîê Enter passphrase to unlock access.enc", "#7ef29b");
        awaitingPassword = true;
        mainInputLine.classList.add('hidden');
        passwordLine.classList.remove('hidden');
        passwordInput.focus();
      }
      break;

    case "clear":
      output.innerHTML = "";
      print("Session reset.", "#9fb3c8");
      stage = 0;
      break;

    default:
      print(`bash: ${cmd}: command not found`, "#f2a6a6");
  }
}

function handlePassword(pass) {
  if (pass === "MEOWS") {
    simulateDecrypt();
  } else {
    attemptsLeft--;
    if (attemptsLeft > 0) {
      print(`‚ùå Incorrect password. Try again. (${attemptsLeft} attempt${attemptsLeft > 1 ? 's' : ''} left)`, "#f2a6a6");
    } else {
      lockSystem(true);
    }
  }
}

function lockSystem(missionFailed = false) {
  mainInputLine.classList.add('hidden');
  passwordLine.classList.add('hidden');
  const msg = missionFailed ? "‚ùå MISSION FAILED ‚Äî ACCESS LOCKED PERMANENTLY." : "‚ùå SYSTEM LOCKDOWN ‚Äî SESSION TERMINATED.";
  print(msg, "#ff4d4d");
  clearInterval(timerInterval);
}

async function simulateDecrypt() {
  passwordLine.classList.add('hidden');
  
  await print("[Decrypting access.enc...]", "#9fb3c8");
  await new Promise(resolve => setTimeout(resolve, 300));
  
  // Create progress bar
  const progressContainer = document.createElement('div');
  progressContainer.className = 'progress-bar-container';
  progressContainer.innerHTML = `
    <div class="progress-bar-bg">
      <div class="progress-bar-fill" id="progressFill"></div>
    </div>
    <div class="progress-text" id="progressText">0%</div>
  `;
  output.appendChild(progressContainer);
  
  const progressFill = document.getElementById('progressFill');
  const progressText = document.getElementById('progressText');
  
  // Animate progress bar
  let progress = 0;
  const duration = 2000; 
  const steps = 50;
  const increment = 100 / steps;
  const stepTime = duration / steps;
  
  const progressInterval = setInterval(() => {
    progress += increment;
    if (progress >= 100) {
      progress = 100;
      clearInterval(progressInterval);
      progressFill.style.width = '100%';
      progressText.textContent = '100%';
      
      setTimeout(() => {
        completeDecryption();
      }, 300);
    } else {
      progressFill.style.width = progress + '%';
      progressText.textContent = Math.round(progress) + '%';
    }
  }, stepTime);
  
  const terminalBody = document.querySelector('.terminal-body');
  terminalBody.scrollTop = terminalBody.scrollHeight;
}

async function completeDecryption() {
  await print("", "#7ef29b");
  await print("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê", "#7ef29b");
  await print("     üíæ DECRYPTION COMPLETE", "#7ef29b");
  await print("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê", "#7ef29b");
  await print("", "#7ef29b");
  await print("‚úÖ Decryption successful. File unlocked.", "#7ef29b");
  
  finalizeSuccess();
}

function finalizeSuccess() {
  const successMsg = document.createElement('div');
  successMsg.className = 'output success-message';
  successMsg.innerHTML = `
[ACCESS GRANTED]

>> Mission Status: SUCCESS
>> Data Unlocked: CATNIP_OP_FINAL.enc
>> Agent Performance: EXCELLENT

‚úÖ Operation complete. Well done, agent.`;
  output.appendChild(successMsg);
  
  const terminalBody = document.querySelector('.terminal-body');
  terminalBody.scrollTop = terminalBody.scrollHeight;
  
  
  setTimeout(() => {
    notepadTitle.textContent = `Text Editor ‚Äî access.enc [DECRYPTED]`;
    notepadContent.textContent = files['access.enc.decrypted'];
    notepadWindow.classList.add('show');
    notepadWindow.classList.remove('minimized');
    notepadTask.classList.remove('hidden');
    notepadTask.classList.add('active');
    
    if (!notepadWindow.style.left) {
      notepadWindow.style.left = '120px';
      notepadWindow.style.top = '100px';
    }
  }, 1000);
  
  clearInterval(timerInterval);
  mainInputLine.classList.add('hidden');
  passwordLine.classList.add('hidden');
  buttonContainer.classList.remove('hidden');
  
  
  setTimeout(() => {
    const terminalBody = document.querySelector('.terminal-body');
    terminalBody.scrollTop = terminalBody.scrollHeight;
  }, 100);

  let clues = JSON.parse(localStorage.getItem('ctfClues') || '[]');
  if (!clues.includes(3)) clues.push(3);
  localStorage.setItem('ctfClues', JSON.stringify(clues));
  const progress = JSON.parse(localStorage.getItem('ctfProgress') || '{}');
  progress.stage3 = true;
  localStorage.setItem('ctfProgress', JSON.stringify(progress));
  localStorage.setItem('ctfUpdate', Date.now());
}


setTimeout(() => openTerminal(), 500);
setTimeout(() => boot(), 600);
</script>
</body>
</html>